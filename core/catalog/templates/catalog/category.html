{% extends 'base.html' %}
{% load static %}

{% block title %}TastyCo Men√º{% endblock %}

{% block content %}
<!-- Header -->
<section class="img" style="
    background-image: url({% static 'images/bg_3.jpg' %});
    height: 4cm;
    display: flex;
    align-items: center;
    margin: 0;
    padding: 0;
    position: relative;
">
  <div class="container" style="z-index: 2;">
    <div class="row align-items-center">


      <!-- Text-Zentrum -->
      <div class="col text-center">
        <h1 class="mb-1 bread" style="font-size: 24px; color: white;">{{ category.name }}</h1>
        <p class="breadcrumbs mb-0" style="font-size: 13px; color: white;">
          <span class="mr-2"><a href="/" style="color: white;">Home</a></span>
          <span style="color: white;">{{ category.name }}</span>
        </p>
      </div>

    </div>
  </div>
</section>


<!-- Produkte -->
<div class="container-fluid py-5 px-4">
  {% if products %}
    <div class="row g-1 justify-content-center">
      {% for product in products %}
        <div class="d-flex align-items-stretch" style="width: 26%; min-width: 320px; max-width: 340px; margin: 0 auto;">

          <div class="p-3 w-100 d-flex rounded"
               style="background-color: #1a1a1a; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.5); min-height: 340px; max-height: 480px;">

            <!-- Bild -->
            <div style="flex: 1.6;">
              {% if product.productimage_set.first %}
                <img src="{{ product.productimage_set.first.image.url }}"
                     alt="{{ product.name }}"
                     class="img-fluid rounded"
                     style="height: 100%; width: 100%; object-fit: cover;">
              {% else %}
                <img src="{% static 'catalog/images/default-product.jpg' %}"
                     alt="Kein Bild"
                     class="img-fluid rounded"
                     style="height: 100%; width: 100%; object-fit: cover;">
              {% endif %}
            </div>

            <!-- Textblock -->
            <div class="text-white ps-3 d-flex flex-column justify-content-between align-items-center text-center" style="flex: 1;">
              <div class="w-100">
                <h6 class="mb-2" style="font-weight: 600;">{{ product.name }}</h6>
                <p class="mb-2" style="font-size: 13px; color: #aaa;">{{ product.description|default:"–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"|truncatewords:12 }}</p>
                <p class="mb-3" style="color: #fbb034; font-weight: bold;">{{ product.price }} —Å–æ–º</p>
              </div>

              <div class="w-100 d-flex flex-column align-items-center">
                <a href="{% url 'product_detail' product.id %}"
                   class="btn btn-sm btn-outline-light mb-2"
                   style="width: 85%; font-size: 14px; padding: 2px 4px;">
                  –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                </a>

                <form method="post" action="{% url 'cart_add' product.id %}" style="width: 85%;">
                  {% csrf_token %}
                  <button type="submit"
                          class="btn btn-sm btn-outline-light w-100"
                          style="font-size: 14px; padding: 2px 4px;">
                    –î–æ–±–∞–≤–∏—Ç—å –≤ üõí
                  </button>
                </form>
              </div>
            </div>

          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if is_paginated %}
    <div class="row justify-content-center mt-4">
      <div class="col-auto">
        <nav>
          <ul class="pagination">
            {% if page_obj.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">‚Äπ</a></li>
            {% endif %}
            {% for num in paginator.page_range %}
              {% if page_obj.number == num %}
                <li class="page-item active"><a class="page-link" href="#">{{ num }}</a></li>
              {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}
            {% if page_obj.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">‚Ä∫</a></li>
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>
    {% endif %}
  {% else %}
    <div class="text-center text-white">
      <h4>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–æ–≤.</h4>
    </div>
  {% endif %}
</div>
{% endblock %}